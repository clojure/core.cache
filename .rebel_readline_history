1771730881107:(require '[clojure.core.cache :as cache] '[clojure.core.cache.wrapped :as cache-wrapped])
1771730883786:(let [thread-count 20\n      cache-atom (-> {}\n                   (cache/ttl-cache-factory :ttl 120000)\n                   (cache/lu-cache-factory :threshold 100)\n                   (atom))\n      latch (java.util.concurrent.CountDownLatch. thread-count)\n      invocations-counter (atom 0)]\n (doseq [i (range thread-count)]\n   (println "starting thread" i)\n   (.start (Thread. (fn []\n                     (cache-wrapped/lookup-or-miss cache-atom "my-key"\n                                                   (fn [k]\n                                                     (swap! invocations-counter inc)\n                                                     (Thread/sleep 3000)\n                                                     "some value"))\n                     (.countDown latch)))))\n (.await latch)\n (deref invocations-counter))
1771874817202:(force (delay ((fn [] (throw (Exception. "bad"))))))
1771874830891:(def x (force (delay ((fn [] (throw (Exception. "bad")))))))
1771874832688:x
1771875362757:(def p (promise))
1771875366556:(realized? p)
1771875376098:(deliver p 42)
1771875377638:(realized? p)
1771875417454:(force p)
1771875420076:p
1771875423512:@p
1771879609917:(def x (delay (throw (Exception. "bad"))))
1771879610748:x
1771879620704:(force x)
1771879622323:x
1771879802447:(def x (with-meta (delay (throw (Exception. "bad"))) {::core.cache.added true}))
1771885580329:(source force)
